# certificate files
$DefaultNetstreamDriverCAFile /usr/local/share/ca-certificates/web-root.crt
$DefaultNetstreamDriverCertFile /opt/tls/certificate.crt
$DefaultNetstreamDriverKeyFile /opt/tls/private.key

# use gtls netstream driver
$DefaultNetstreamDriver gtls

# require TLS for the connection
$ActionSendStreamDriverMode 1

# server is authenticated
$ActionSendStreamDriverAuthMode x509/name
$ActionSendStreamDriverPermittedPeer backup.imovies.ch

# include audit log generated by auditd
$ModLoad imfile
$InputFileName /var/log/audit/audit.log
$InputFileTag tag_audit_log:
$InputFileStateFile audit_log
$InputFileSeverity info
$InputFileFacility local6
$InputRunFileMonitor

# possible TODO: apparently RELP would be even better?

# send all logs to the backup server. two @@ => TCP
# NOTE: (o) is not a mistake, see https://rsyslog.readthedocs.io/en/latest/tutorials/tls.html
*.* @@(o)backup.imovies.ch:10514